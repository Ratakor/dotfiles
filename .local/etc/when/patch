--- /usr/bin/when	2022-11-12 11:46:31.000000000 +0100
+++ when	2023-02-11 00:53:55.807648570 +0100
@@ -471,7 +471,7 @@
 
 =head1 LOCATION AND FORMAT OF THE PREFERENCES FILE
 
-Most people will have their preferences file in ~/.when/preferences.
+Most people will have their preferences file in $ENV{XDG_CONFIG_HOME}/when/preferences.
 Those who prefer to keep their home directory uncluttered with dotfiles
 can use one of the following standard possibilities defined by the XDG standard.
 In decreasing order of priority:
@@ -712,7 +712,7 @@
   'language'=>'en',                 # user's language; this is normally overridden by $LANG environment var.
   'past'=>-1,                       # how many days into the past the report extends
   'future'=>14,                     # ...and how far into the future
-  'calendar'=>'~/.when/calendar',   # where to find the calendar file
+  'calendar'=>"$ENV{XDG_CONFIG_HOME}/when/calendar",   # where to find the calendar file
   'wrap'=>80,                       # 0 means don't wrap; otherwise, wrap display to this many columns
   'wrap_auto'=>0,                   # Try to detect width of terminal automatically, if it's a TTY.
   'wrap_max'=>-1,                   # If positive, sets a maximum with, overriding wrap_auto if necessary.
@@ -983,7 +983,7 @@
         'illegal_month'=>"Mese illegale: %s\n",
         'illegal_day_of_month'=>"Giorno del mese illegale: %s\n",
         'first_time_not_tty'=>"Per impostare il tuo calendario, richiama il comando ``when'' in un terminale interattivo.\n",
-        'ask_if_set_up'=>("Adesso puoi impostare il tuo calendario. Questo avviene creando una directory ~/.when e creando\n".
+        'ask_if_set_up'=>("Adesso puoi impostare il tuo calendario. Questo avviene creando una directory $ENV{XDG_CONFIG_HOME}/when e creando\n".
                           "un paio di file al suo interno. Se si desidera procedere, digitare y e premere invio.\n"),
         'error_creating_dir'=>"Errore durante la creazione della directory %s\n",
         'ask_for_editor'=>("Puoi modificare il tuo calendario usando il tuo editor preferito. Per favore, inserire il comando\n"
@@ -1009,7 +1009,7 @@
         'illegal_month'=>"Niew${l_polish}a${s_polish}ciwy miesi${a_polish}c: %s\n",
         'illegal_day_of_month'=>"Niew${l_polish}a${s_polish}ciwy dzie${n_polish}: %s\n",
         'first_time_not_tty'=>"Aby zainicjowac kalendarz u${zz_polish}yj komendy ``when'' w oknie terminala.\n",
-        'ask_if_set_up'=>("Za chwil${e_polish} rozpocznie sie konfiguracja kalendarza. Stworzony zostanie katalog ~/.when w\n kt${o_polish}rym pojawi${a_polish} sie pliki konfiguracyjne. Je${s_polish}li zgadzasz si${e_polish} na t${a_polish} operacj${e_polish} wci${s_polish}nij\n klawisz 'y' i potwierd${z_polish} klawiszem Enter.\n"),
+        'ask_if_set_up'=>("Za chwil${e_polish} rozpocznie sie konfiguracja kalendarza. Stworzony zostanie katalog $ENV{XDG_CONFIG_HOME}/when w\n kt${o_polish}rym pojawi${a_polish} sie pliki konfiguracyjne. Je${s_polish}li zgadzasz si${e_polish} na t${a_polish} operacj${e_polish} wci${s_polish}nij\n klawisz 'y' i potwierd${z_polish} klawiszem Enter.\n"),
         'error_creating_dir'=>"B${l_polish}${a_polish}d w tworzeniu katalogu %s\n",
         'ask_for_editor'=>("Mo${zz_polish}esz edytowa${c_polish} sw${o_polish}j plik kalendarza u${zz_polish}ywaj${a_polish}c ulubionego edytora. Podaj komend${e_polish} do uruchamienia\n".
                 	"edytora lub wci${s_polish}nij Enter aby u${zz_polish}ywa${c_polish} standardowego edytora:\n"),
@@ -1040,7 +1040,7 @@
         'illegal_month'=>"Ongeldige maand: %s\n",
         'illegal_day_of_month'=>"Ongeldige dag van de maand: %s\n",
         'first_time_not_tty'=>"Voer de opdracht ``when'' uit in de commandoregel om uw kalender in te stellen.\n",
-        'ask_if_set_up'=>("U kan nu uw kalender instellen. U dient de map ~/.when aan te maken samen met\n".
+        'ask_if_set_up'=>("U kan nu uw kalender instellen. U dient de map $ENV{XDG_CONFIG_HOME}/when aan te maken samen met\n".
                           "een paar bestanden erin. Als U dit graag wil doen, toets y in en druk op Enter.\n"),
         'error_creating_dir'=>"Kon de map %s niet aanmaken\n",
         'ask_for_editor'=>("U kan uw kalendar met uw favoriete editor bewerken. Geef de opdracht in om uw voorkeurseditor\n"
@@ -1073,7 +1073,7 @@
         'illegal_month'=>("Unzul${a_uml}ssiger Monat: %s\n"),
         'illegal_day_of_month'=>("Unzul${a_uml}ssiger Tag des Monats: %s\n"),
         'first_time_not_tty'=>("Um Ihren Kalernder aufzubauen, f${u_uml}hren Sie den Befehl ``when'' in einem interaktiven Terminalfenster aus.\n"),
-        'ask_if_set_up'=>("Sie k${o_uml}nnen jetzt Ihren Kalender aufbauen. Dies hat zur Folge, dass ein Verzeichnis ~/.when angelegt wird, und in ihm\n".
+        'ask_if_set_up'=>("Sie k${o_uml}nnen jetzt Ihren Kalender aufbauen. Dies hat zur Folge, dass ein Verzeichnis $ENV{XDG_CONFIG_HOME}/when angelegt wird, und in ihm\n".
                           "ein paar Dateien. Wenn Sie das machen wollen, dr${u_uml}cken Sie y, gefolgt von ENTER.\n"),
         'error_creating_dir'=>("Fehler beim Anlegen des Verzeichnisses %s\n"),
         'ask_for_editor'=>("Sie k${o_uml}nnen den Kalender mit Ihren Lieblings-Editor bearbeiten. Bitte geben Sie dazu den Befehl zum Starten des Editors ein\n"
@@ -1107,7 +1107,7 @@
         'illegal_month'=>"Neplatny mesic: %s\n",
         'illegal_day_of_month'=>"Neplatny den v mesici: %s\n",
         'first_time_not_tty'=>"Pro nastaveni vaseho kalendare, spustte prikaz ``when'' v okne terminalu.\n",
-        'ask_if_set_up'=>("Nyni muzete nastavit vas kalendar. To vytvori adresar ~/.when, a\n".
+        'ask_if_set_up'=>("Nyni muzete nastavit vas kalendar. To vytvori adresar $ENV{XDG_CONFIG_HOME}/when, a\n".
                           "a v nem nekolik souboru. Pro souhlas stisknete y a potvrdte klavesou return.\n"),
         'error_creating_dir'=>"Chyba pri vytvareni adresare %s\n",
         'ask_for_editor'=>("Kalendar muzete editovat pouzitim vaseho oblibeneho editoru. Prosim zadejte prikaz\n"
@@ -1139,7 +1139,7 @@
         'illegal_month'=>"Ugyldig m${a_ring}ned: %s\n",
         'illegal_day_of_month'=>"Ugyldig dag i m${a_ring}neden: %s\n",
         'first_time_not_tty'=>"For at oprette en kalender, k${o_slash}r kommandoen ``when'' i et interaktivt terminalvindue.\n",
-        'ask_if_set_up'=>("Der kan nu oprettes en kalender. Derved oprettes en mappe ~/.when, med et par filer i sig.\n".
+        'ask_if_set_up'=>("Der kan nu oprettes en kalender. Derved oprettes en mappe $ENV{XDG_CONFIG_HOME}/when, med et par filer i sig.\n".
                           "For at g${o_slash}re dette, tast y efterfulgt af return.\n"),
         'error_creating_dir'=>"Fejl under oprettelsen af mappen %s\n",
         'ask_for_editor'=>("Kalenderen kan nu redigeres med valgfri editor. Indtast den kommando, der ${o_slash}nskes brugt\n"
@@ -1171,7 +1171,7 @@
         'illegal_month'=>"Ogiltig m${a_ring}nad: %s\n",
         'illegal_day_of_month'=>"Ogiltig dag i m${a_ring}naden: %s\n",
         'first_time_not_tty'=>"F${o_uml}r att uppr${a_uml}tta din kalender, k${o_uml} kommandot ``when'' i ett interaktivt terminalf${o_uml}nster.\n",
-        'ask_if_set_up'=>("Din kalendar kan nu uppr${a_uml}ttas. Katalogen ~/.when och ett par filer kommer att skapas.\n".
+        'ask_if_set_up'=>("Din kalendar kan nu uppr${a_uml}ttas. Katalogen $ENV{XDG_CONFIG_HOME}/when och ett par filer kommer att skapas.\n".
                           "F${o_uml} att g${o_uml}ra detta, skriv y och tryck Return.\n"),
         'error_creating_dir'=>"Katalogen %s kunde ej skapas\n",
         'ask_for_editor'=>("Du kan nu redigera din kalender med valfri editor. Mata in det kommando som du vill anv${a_uml}nda f${o_uml} redigering\n"
@@ -1203,7 +1203,7 @@
         'illegal_month'=>"Valor ilegal para el campo mes: %s\n",
         'illegal_day_of_month'=>"Valor ilegal para el d${i_acute}a del mes: %s\n",
         'first_time_not_tty'=>"Para configurar tu calendario, ejecuta el comando ``when'' en una ventana de terminal interactivo.\n",
-        'ask_if_set_up'=>("Puedes configurar ahora tu calendario. Esto implica crear el directorio ~/.when y un par de archivos en ${e_acute}l. Si deseas hacer esto, teclea 'y' y presiona enter.\n"),
+        'ask_if_set_up'=>("Puedes configurar ahora tu calendario. Esto implica crear el directorio $ENV{XDG_CONFIG_HOME}/when y un par de archivos en ${e_acute}l. Si deseas hacer esto, teclea 'y' y presiona enter.\n"),
         'error_creating_dir'=>"Error creando directorio %s\n",
         'ask_for_editor'=>("Puedes editar tu calendario usando tu editor favorito. Introduce el comando necesario \npara lanzar tu editor o presiona enter para aceptar el editor por defecto:\n"),
         'error_creating_prefs'=>"Error creando el archivo %s\n",
@@ -1233,7 +1233,7 @@
         'illegal_month'=>"Λάθος μήνας: %s\n",
         'illegal_day_of_month'=>"Λάθος ημέρα του μήνα: %s\n",
         'first_time_not_tty'=>"Για να ρυθμίσετε αρχικά το ημερολόγιο, εκτελέστε την εντολή ``when'' σε ένα παράθυρο τερματικού.\n",
-        'ask_if_set_up'=>("Μπορείτε τώρα να ρυθμίσετε το ημερολόγιο. Αυτό περιλαμβάνει τη δημιουργία του καταλόγου ~/.when, και τη δημιουργία\n".
+        'ask_if_set_up'=>("Μπορείτε τώρα να ρυθμίσετε το ημερολόγιο. Αυτό περιλαμβάνει τη δημιουργία του καταλόγου $ENV{XDG_CONFIG_HOME}/when, και τη δημιουργία\n".
                           "μερικών αρχείων εκεί. Αν επιθυμείτε να συνεχίσετε, πληκτρολογήστε y και στη συνέχεια το πλήκτρο enter.\n"),
         'error_creating_dir'=>"Σφάλμα κατά τη δημιουργία του καταλόγου %s\n",
         'ask_for_editor'=>("Μπορείτε να επεξεργαστείτε το ημερολόγιο σας χρησιμοποιώντας τον αγαπημένο σας επεξεργαστη κειμένου. Παρακαλώ εισάγετε την εντολή\n"
@@ -1267,7 +1267,7 @@
         'illegal_month'=>"Lun${a_breve} ilegal${a_breve}: %s\n",
         'illegal_day_of_month'=>"Ziua lunii nepermis${a_breve}: %s\n",
         'first_time_not_tty'=>"Pentru a configura calendarul, folosi${t_commabelow}i comanda ${quot_open}when${quot_close} ${i_circumflex}n terminalul intercativ.\n",
-        'ask_if_set_up'=>("Pute${t_commabelow}i s${a_breve} v${a_breve} configura${t_commabelow}i acum calendarul. Aceasta implic${a_breve} crearea directorului ~/.when, ${s_commabelow}i a\n".
+        'ask_if_set_up'=>("Pute${t_commabelow}i s${a_breve} v${a_breve} configura${t_commabelow}i acum calendarul. Aceasta implic${a_breve} crearea directorului $ENV{XDG_CONFIG_HOME}/when, ${s_commabelow}i a\n".
           "unor fi${s_commabelow}iere ${i_circumflex}n el. Dac${a_breve} dori${t_commabelow}i asta, ap${a_breve}sa${t_commabelow}i tasta y ${s_commabelow}i apoi enter.\n"),
         'error_creating_dir'=>"Eroare la crearea directorului %s\n",
         'ask_for_editor'=>("Pute${t_commabelow}i edita fi${s_commabelow}ierul calendar cu editorul favorit. V${a_breve} rug${a_breve}m s${a_breve} da${t_commabelow}i comanda pe care\n"
@@ -1303,7 +1303,7 @@
         'illegal_month'=>"Mois incorrect : %s\n",
         'illegal_day_of_month'=>"Jour du mois incorrect : %s\n",
         'first_time_not_tty'=>"Pour installer le calendrier lancez ``when'' dans un terminal interactif.\n",
-        'ask_if_set_up'=>("Vous pouvez maintenant installer votre calendrier. C'est-à-dire créer le répertoire ~/.when, et y créer\n".
+        'ask_if_set_up'=>("Vous pouvez maintenant installer votre calendrier. C'est-à-dire créer le répertoire $ENV{XDG_CONFIG_HOME}/when, et y créer\n".
                           "une paire de fichiers. Si c'est ceci que vous souhaitez, tapez 'y' puis 'entrée'.\n"),
         'error_creating_dir'=>"Erreur lors de la création du répertoire %s\n",
         'ask_for_editor'=>("Vous pouvez éditer votre calendrier avec votre éditeur de texte favori. Entrez la commande correspondante\n"
@@ -1339,7 +1339,7 @@
         'illegal_month'=>"Некоректний місяць: %s\n",
         'illegal_day_of_month'=>"Некоректний день місяця: %s\n",
         'first_time_not_tty'=>"Для налаштування вашого календаря, виконайте команду ``when'' у терміналі.\n",
-        'ask_if_set_up'=>("Зараз ви можете налаштувати ваш календар. Це передбачає, що буде створена директорія ~/.when\n".
+        'ask_if_set_up'=>("Зараз ви можете налаштувати ваш календар. Це передбачає, що буде створена директорія $ENV{XDG_CONFIG_HOME}/when\n".
                           "та декілька файлів в ній. Якщо ви хочете цього, натисніть Y та Enter.\n"),
         'error_creating_dir'=>"Помилка при створенні директорії %s\n",
         'ask_for_editor'=>("Ви можете редагувати ваш календар застосовуючи ваш улюблений редактор. Введіть команду, яка запускає ваш редактор,\n"
@@ -1375,7 +1375,7 @@
         'illegal_month'=>"Mês ilegal: %s\n",
         'illegal_day_of_month'=>"Dia do mês ilegal: %s\n",
         'first_time_not_tty'=>"Para configurar seu calendário, use o comando ``when'' em uma janela interativa de terminal.\n",
-        'ask_if_set_up'=>("Você pode agora configurar seu calendário. Isso envolve criar um diretório ~/.when, e fazendo\n".
+        'ask_if_set_up'=>("Você pode agora configurar seu calendário. Isso envolve criar um diretório $ENV{XDG_CONFIG_HOME}/when, e fazendo\n".
                                   "alguns arquivos nele. Se você quer fazer isso, digite y e aperte return"),
         'error_creating_dir'=>"Erro ao criar o arquivo %s",
         'ask_for_editor'=>("Você pode editar seu arquivo de calendário usando seu editor favorito. Por favor, entre com o comando que você\n"
@@ -1412,7 +1412,7 @@
         'illegal_month'=>"Illegal month: %s\n",
         'illegal_day_of_month'=>"Illegal day of the month: %s\n",
         'first_time_not_tty'=>"To set up your calendar, do the command ``when'' in an interactive terminal window.\n",
-        'ask_if_set_up'=>("You can now set up your calendar. This involves creating a directory ~/.when, and making\n".
+        'ask_if_set_up'=>("You can now set up your calendar. This involves creating a directory $ENV{XDG_CONFIG_HOME}/when, and making\n".
                           "a couple of files in it. If you want to do this, type y and hit return.\n"),
         'error_creating_dir'=>"Error creating the directory %s\n",
         'ask_for_editor'=>("You can edit your calendar file using your favorite editor. Please enter the command you\n"
