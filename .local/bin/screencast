#!/bin/sh
# script for screencast because obs is cringe

printf "Title: "
read TITLE

TITLE="$(echo $TITLE | sed 's/ /_/g')_$(date '+%s').mp4"
mkdir -p "$XDG_VIDEOS_DIR/screencasts"

printf "Record will start in"
printf " 3" && sleep 1s
printf " 2" && sleep 1s
printf " 1" && sleep 1s
printf "\nRecording started, press q 3s after you want to stop to stop.\n"

ffmpeg -loglevel fatal -s "$(xrandr | sed -n 's/\s*\([0-9]\+x[0-9]\+\).*\*.*/\1/p')" \
       -framerate 30 -f x11grab -i "$DISPLAY" -f alsa -i default -ar 44100 \
       -c:v libx264rgb -crf 0 -preset ultrafast -color_range 2 -c:a aac \
       "$XDG_VIDEOS_DIR/screencasts/$TITLE"

#ffmpeg -loglevel fatal -s "$(xrandr | sed -n 's/\s*\([0-9]\+x[0-9]\+\).*\*.*/\1/p')" \
#       -framerate 30 -f x11grab -i "$DISPLAY" -f pulse -i default -ar 44100 \
#       -c:v libx264rgb -crf 0 -preset ultrafast -color_range 2 -c:a aac \
#       "$XDG_VIDEOS_DIR/screencasts/$TITLE"
