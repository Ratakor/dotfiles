#!/bin/sh
# set a random wallpaper
# to ignore a folder or a file put it in IGNORE like "file1|folder|file2"

#PROG="feh --bg-fill --no-fehbg"
#PROG="xwallpaper --zoom"
PROG="hsetroot -cover"
WPDIR="${1:-$XDG_DATA_HOME/wallpapers}"
IGNORE="nsfw"

all="$(find "$WPDIR" -type f ! -path '*/.git*' ! -name 'README.md')"
wp="$(printf '%s' "$all" | shuf -n 1)"

while printf '%s' "$wp" | grep -q -E "$IGNORE" ; do
	wp="$(printf '%s' "$all" | shuf -n 1 -)"
done

$PROG "$wp" 1>/dev/null
